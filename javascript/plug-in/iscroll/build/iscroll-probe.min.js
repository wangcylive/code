/* iScroll v5.1.3 ~ (c) 2008-2014 Matteo Spinelli ~ http://cubiq.org/license */
(function(h,b,e){var f=h.requestAnimationFrame||h.webkitRequestAnimationFrame||h.mozRequestAnimationFrame||h.oRequestAnimationFrame||h.msRequestAnimationFrame||function(i){h.setTimeout(i,1000/60)};var g=(function(){var n={};var i=b.createElement("div").style;var l=(function(){var r=["t","webkitT","MozT","msT","OT"],q,o=0,p=r.length;for(;o<p;o++){q=r[o]+"ransform";if(q in i){return r[o].substr(0,r[o].length-1)}}return false})();function j(o){if(l===false){return false}if(l===""){return o}return l+o.charAt(0).toUpperCase()+o.substr(1)}n.getTime=Date.now||function m(){return new Date().getTime()};n.extend=function(q,p){for(var o in p){q[o]=p[o]}};n.addEvent=function(p,r,q,o){p.addEventListener(r,q,!!o)};n.removeEvent=function(p,r,q,o){p.removeEventListener(r,q,!!o)};n.prefixPointerEvent=function(o){return h.MSPointerEvent?"MSPointer"+o.charAt(9).toUpperCase()+o.substr(10):o};n.momentum=function(o,v,w,t,x,p){var r=o-v,u=e.abs(r)/w,q,s;p=p===undefined?0.0006:p;q=o+(u*u)/(2*p)*(r<0?-1:1);s=u/p;if(q<t){q=x?t-(x/2.5*(u/8)):t;r=e.abs(q-o);s=r/u}else{if(q>0){q=x?x/2.5*(u/8):0;r=e.abs(o)+q;s=r/u}}return{destination:e.round(q),duration:s}};var k=j("transform");n.extend(n,{hasTransform:k!==false,hasPerspective:j("perspective") in i,hasTouch:"ontouchstart" in h,hasPointer:h.PointerEvent||h.MSPointerEvent,hasTransition:j("transition") in i});n.isBadAndroid=/Android /.test(h.navigator.appVersion)&&!(/Chrome\/\d/.test(h.navigator.appVersion));n.extend(n.style={},{transform:k,transitionTimingFunction:j("transitionTimingFunction"),transitionDuration:j("transitionDuration"),transitionDelay:j("transitionDelay"),transformOrigin:j("transformOrigin")});n.hasClass=function(p,o){var q=new RegExp("(^|\\s)"+o+"(\\s|$)");return q.test(p.className)};n.addClass=function(p,o){if(n.hasClass(p,o)){return}var q=p.className.split(" ");q.push(o);p.className=q.join(" ")};n.removeClass=function(p,o){if(!n.hasClass(p,o)){return}var q=new RegExp("(^|\\s)"+o+"(\\s|$)","g");p.className=p.className.replace(q," ")};n.offset=function(o){var p=-o.offsetLeft,q=-o.offsetTop;while(o=o.offsetParent){p-=o.offsetLeft;q-=o.offsetTop}return{left:p,top:q}};n.preventDefaultException=function(o,p){for(var q in p){if(p[q].test(o[q])){return true}}return false};n.extend(n.eventType={},{touchstart:1,touchmove:1,touchend:1,mousedown:2,mousemove:2,mouseup:2,pointerdown:3,pointermove:3,pointerup:3,MSPointerDown:3,MSPointerMove:3,MSPointerUp:3});n.extend(n.ease={},{quadratic:{style:"cubic-bezier(0.25, 0.46, 0.45, 0.94)",fn:function(o){return o*(2-o)}},circular:{style:"cubic-bezier(0.1, 0.57, 0.1, 1)",fn:function(o){return e.sqrt(1-(--o*o))}},back:{style:"cubic-bezier(0.175, 0.885, 0.32, 1.275)",fn:function(p){var o=4;return(p=p-1)*p*((o+1)*p+o)+1}},bounce:{style:"",fn:function(o){if((o/=1)<(1/2.75)){return 7.5625*o*o}else{if(o<(2/2.75)){return 7.5625*(o-=(1.5/2.75))*o+0.75}else{if(o<(2.5/2.75)){return 7.5625*(o-=(2.25/2.75))*o+0.9375}else{return 7.5625*(o-=(2.625/2.75))*o+0.984375}}}}},elastic:{style:"",fn:function(q){var p=0.22,o=0.4;if(q===0){return 0}if(q==1){return 1}return(o*e.pow(2,-10*q)*e.sin((q-p/4)*(2*e.PI)/p)+1)}}});n.tap=function(o,q){var p=b.createEvent("Event");p.initEvent(q,true,true);p.pageX=o.pageX;p.pageY=o.pageY;o.target.dispatchEvent(p)};n.click=function(o){var q=o.target,p;if(!(/(SELECT|INPUT|TEXTAREA)/i).test(q.tagName)){p=b.createEvent("MouseEvents");p.initMouseEvent("click",true,true,o.view,1,q.screenX,q.screenY,q.clientX,q.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,0,null);p._constructed=true;q.dispatchEvent(p)}};return n})();function d(j,l){this.wrapper=typeof j=="string"?b.querySelector(j):j;this.scroller=this.wrapper.children[0];this.scrollerStyle=this.scroller.style;this.options={resizeScrollbars:true,mouseWheelSpeed:20,snapThreshold:0.334,startX:0,startY:0,scrollY:true,directionLockThreshold:5,momentum:true,bounce:true,bounceTime:600,bounceEasing:"",preventDefault:true,preventDefaultException:{tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},HWCompositing:true,useTransition:true,useTransform:true};for(var k in l){this.options[k]=l[k]}this.translateZ=this.options.HWCompositing&&g.hasPerspective?" translateZ(0)":"";this.options.useTransition=g.hasTransition&&this.options.useTransition;this.options.useTransform=g.hasTransform&&this.options.useTransform;this.options.eventPassthrough=this.options.eventPassthrough===true?"vertical":this.options.eventPassthrough;this.options.preventDefault=!this.options.eventPassthrough&&this.options.preventDefault;this.options.scrollY=this.options.eventPassthrough=="vertical"?false:this.options.scrollY;this.options.scrollX=this.options.eventPassthrough=="horizontal"?false:this.options.scrollX;this.options.freeScroll=this.options.freeScroll&&!this.options.eventPassthrough;this.options.directionLockThreshold=this.options.eventPassthrough?0:this.options.directionLockThreshold;this.options.bounceEasing=typeof this.options.bounceEasing=="string"?g.ease[this.options.bounceEasing]||g.ease.circular:this.options.bounceEasing;this.options.resizePolling=this.options.resizePolling===undefined?60:this.options.resizePolling;if(this.options.tap===true){this.options.tap="tap"}if(this.options.shrinkScrollbars=="scale"){this.options.useTransition=false}this.options.invertWheelDirection=this.options.invertWheelDirection?-1:1;if(this.options.probeType==3){this.options.useTransition=false}this.x=0;this.y=0;this.directionX=0;this.directionY=0;this._events={};this._init();this.refresh();this.scrollTo(this.options.startX,this.options.startY);this.enable()}d.prototype={version:"5.1.3",_init:function(){this._initEvents();if(this.options.scrollbars||this.options.indicators){this._initIndicators()}if(this.options.mouseWheel){this._initWheel()}if(this.options.snap){this._initSnap()}if(this.options.keyBindings){this._initKeys()}},destroy:function(){this._initEvents(true);this._execEvent("destroy")},_transitionEnd:function(i){if(i.target!=this.scroller||!this.isInTransition){return}this._transitionTime();if(!this.resetPosition(this.options.bounceTime)){this.isInTransition=false;this._execEvent("scrollEnd")}},_start:function(i){if(g.eventType[i.type]!=1){if(i.button!==0){return}}if(!this.enabled||(this.initiated&&g.eventType[i.type]!==this.initiated)){return}if(this.options.preventDefault&&!g.isBadAndroid&&!g.preventDefaultException(i.target,this.options.preventDefaultException)){i.preventDefault()}var j=i.touches?i.touches[0]:i,k;this.initiated=g.eventType[i.type];this.moved=false;this.distX=0;this.distY=0;this.directionX=0;this.directionY=0;this.directionLocked=0;this._transitionTime();this.startTime=g.getTime();if(this.options.useTransition&&this.isInTransition){this.isInTransition=false;k=this.getComputedPosition();this._translate(e.round(k.x),e.round(k.y));this._execEvent("scrollEnd")}else{if(!this.options.useTransition&&this.isAnimating){this.isAnimating=false;this._execEvent("scrollEnd")}}this.startX=this.x;this.startY=this.y;this.absStartX=this.x;this.absStartY=this.y;this.pointX=j.pageX;this.pointY=j.pageY;this._execEvent("beforeScrollStart")},_move:function(m){if(!this.enabled||g.eventType[m.type]!==this.initiated){return}if(this.options.preventDefault){m.preventDefault()}var p=m.touches?m.touches[0]:m,k=p.pageX-this.pointX,l=p.pageY-this.pointY,q=g.getTime(),n,o,i,j;this.pointX=p.pageX;this.pointY=p.pageY;this.distX+=k;this.distY+=l;i=e.abs(this.distX);j=e.abs(this.distY);if(q-this.endTime>300&&(i<10&&j<10)){return}if(!this.directionLocked&&!this.options.freeScroll){if(i>j+this.options.directionLockThreshold){this.directionLocked="h"}else{if(j>=i+this.options.directionLockThreshold){this.directionLocked="v"}else{this.directionLocked="n"}}}if(this.directionLocked=="h"){if(this.options.eventPassthrough=="vertical"){m.preventDefault()}else{if(this.options.eventPassthrough=="horizontal"){this.initiated=false;return}}l=0}else{if(this.directionLocked=="v"){if(this.options.eventPassthrough=="horizontal"){m.preventDefault()}else{if(this.options.eventPassthrough=="vertical"){this.initiated=false;return}}k=0}}k=this.hasHorizontalScroll?k:0;l=this.hasVerticalScroll?l:0;n=this.x+k;o=this.y+l;if(n>0||n<this.maxScrollX){n=this.options.bounce?this.x+k/3:n>0?0:this.maxScrollX}if(o>0||o<this.maxScrollY){o=this.options.bounce?this.y+l/3:o>0?0:this.maxScrollY}this.directionX=k>0?-1:k<0?1:0;this.directionY=l>0?-1:l<0?1:0;if(!this.moved){this._execEvent("scrollStart")}this.moved=true;this._translate(n,o);if(q-this.startTime>300){this.startTime=q;this.startX=this.x;this.startY=this.y;if(this.options.probeType==1){this._execEvent("scroll")}}if(this.options.probeType>1){this._execEvent("scroll")}},_end:function(l){if(!this.enabled||g.eventType[l.type]!==this.initiated){return}if(this.options.preventDefault&&!g.preventDefaultException(l.target,this.options.preventDefaultException)){l.preventDefault()}var r=l.changedTouches?l.changedTouches[0]:l,n,o,k=g.getTime()-this.startTime,p=e.round(this.x),q=e.round(this.y),i=e.abs(p-this.startX),j=e.abs(q-this.startY),t=0,m="";this.isInTransition=0;this.initiated=0;this.endTime=g.getTime();if(this.resetPosition(this.options.bounceTime)){return}this.scrollTo(p,q);if(!this.moved){if(this.options.tap){g.tap(l,this.options.tap)}if(this.options.click){g.click(l)}this._execEvent("scrollCancel");return}if(this._events.flick&&k<200&&i<100&&j<100){this._execEvent("flick");return}if(this.options.momentum&&k<300){n=this.hasHorizontalScroll?g.momentum(this.x,this.startX,k,this.maxScrollX,this.options.bounce?this.wrapperWidth:0,this.options.deceleration):{destination:p,duration:0};o=this.hasVerticalScroll?g.momentum(this.y,this.startY,k,this.maxScrollY,this.options.bounce?this.wrapperHeight:0,this.options.deceleration):{destination:q,duration:0};p=n.destination;q=o.destination;t=e.max(n.duration,o.duration);this.isInTransition=1}if(this.options.snap){var s=this._nearestSnap(p,q);this.currentPage=s;t=this.options.snapSpeed||e.max(e.max(e.min(e.abs(p-s.x),1000),e.min(e.abs(q-s.y),1000)),300);p=s.x;q=s.y;this.directionX=0;this.directionY=0;m=this.options.bounceEasing}if(p!=this.x||q!=this.y){if(p>0||p<this.maxScrollX||q>0||q<this.maxScrollY){m=g.ease.quadratic}this.scrollTo(p,q,t,m);return}this._execEvent("scrollEnd")},_resize:function(){var i=this;clearTimeout(this.resizeTimeout);this.resizeTimeout=setTimeout(function(){i.refresh()},this.options.resizePolling)},resetPosition:function(i){var j=this.x,k=this.y;i=i||0;if(!this.hasHorizontalScroll||this.x>0){j=0}else{if(this.x<this.maxScrollX){j=this.maxScrollX}}if(!this.hasVerticalScroll||this.y>0){k=0}else{if(this.y<this.maxScrollY){k=this.maxScrollY}}if(j==this.x&&k==this.y){return false}this.scrollTo(j,k,i,this.options.bounceEasing);return true},disable:function(){this.enabled=false},enable:function(){this.enabled=true},refresh:function(){var i=this.wrapper.offsetHeight;this.wrapperWidth=this.wrapper.clientWidth;this.wrapperHeight=this.wrapper.clientHeight;this.scrollerWidth=this.scroller.offsetWidth;this.scrollerHeight=this.scroller.offsetHeight;this.maxScrollX=this.wrapperWidth-this.scrollerWidth;this.maxScrollY=this.wrapperHeight-this.scrollerHeight;this.hasHorizontalScroll=this.options.scrollX&&this.maxScrollX<0;this.hasVerticalScroll=this.options.scrollY&&this.maxScrollY<0;if(!this.hasHorizontalScroll){this.maxScrollX=0;this.scrollerWidth=this.wrapperWidth}if(!this.hasVerticalScroll){this.maxScrollY=0;this.scrollerHeight=this.wrapperHeight}this.endTime=0;this.directionX=0;this.directionY=0;this.wrapperOffset=g.offset(this.wrapper);this._execEvent("refresh");this.resetPosition()},on:function(j,i){if(!this._events[j]){this._events[j]=[]}this._events[j].push(i)},off:function(k,i){if(!this._events[k]){return}var j=this._events[k].indexOf(i);if(j>-1){this._events[k].splice(j,1)}},_execEvent:function(m){if(!this._events[m]){return}var j=0,k=this._events[m].length;if(!k){return}for(;j<k;j++){this._events[m][j].apply(this,[].slice.call(arguments,1))}},scrollBy:function(k,l,j,i){k=this.x+k;l=this.y+l;j=j||0;this.scrollTo(k,l,j,i)},scrollTo:function(k,l,j,i){i=i||g.ease.circular;this.isInTransition=this.options.useTransition&&j>0;if(!j||(this.options.useTransition&&i.style)){this._transitionTimingFunction(i.style);this._transitionTime(j);this._translate(k,l)}else{this._animate(k,l,j,i.fn)}},scrollToElement:function(j,n,k,l,i){j=j.nodeType?j:this.scroller.querySelector(j);if(!j){return}var m=g.offset(j);m.left-=this.wrapperOffset.left;m.top-=this.wrapperOffset.top;if(k===true){k=e.round(j.offsetWidth/2-this.wrapper.offsetWidth/2)}if(l===true){l=e.round(j.offsetHeight/2-this.wrapper.offsetHeight/2)}m.left-=k||0;m.top-=l||0;m.left=m.left>0?0:m.left<this.maxScrollX?this.maxScrollX:m.left;m.top=m.top>0?0:m.top<this.maxScrollY?this.maxScrollY:m.top;n=n===undefined||n===null||n==="auto"?e.max(e.abs(this.x-m.left),e.abs(this.y-m.top)):n;this.scrollTo(m.left,m.top,n,i)},_transitionTime:function(k){k=k||0;this.scrollerStyle[g.style.transitionDuration]=k+"ms";if(!k&&g.isBadAndroid){this.scrollerStyle[g.style.transitionDuration]="0.001s"}if(this.indicators){for(var j=this.indicators.length;j--;){this.indicators[j].transitionTime(k)}}},_transitionTimingFunction:function(j){this.scrollerStyle[g.style.transitionTimingFunction]=j;if(this.indicators){for(var k=this.indicators.length;k--;){this.indicators[k].transitionTimingFunction(j)}}},_translate:function(k,l){if(this.options.useTransform){this.scrollerStyle[g.style.transform]="translate("+k+"px,"+l+"px)"+this.translateZ}else{k=e.round(k);l=e.round(l);this.scrollerStyle.left=k+"px";this.scrollerStyle.top=l+"px"}this.x=k;this.y=l;if(this.indicators){for(var j=this.indicators.length;j--;){this.indicators[j].updatePosition()}}},_initEvents:function(j){var i=j?g.removeEvent:g.addEvent,k=this.options.bindToWrapper?this.wrapper:h;i(h,"orientationchange",this);i(h,"resize",this);if(this.options.click){i(this.wrapper,"click",this,true)}if(!this.options.disableMouse){i(this.wrapper,"mousedown",this);i(k,"mousemove",this);i(k,"mousecancel",this);i(k,"mouseup",this)}if(g.hasPointer&&!this.options.disablePointer){i(this.wrapper,g.prefixPointerEvent("pointerdown"),this);i(k,g.prefixPointerEvent("pointermove"),this);i(k,g.prefixPointerEvent("pointercancel"),this);i(k,g.prefixPointerEvent("pointerup"),this)}if(g.hasTouch&&!this.options.disableTouch){i(this.wrapper,"touchstart",this);i(k,"touchmove",this);i(k,"touchcancel",this);i(k,"touchend",this)}i(this.scroller,"transitionend",this);i(this.scroller,"webkitTransitionEnd",this);i(this.scroller,"oTransitionEnd",this);i(this.scroller,"MSTransitionEnd",this)},getComputedPosition:function(){var i=h.getComputedStyle(this.scroller,null),j,k;if(this.options.useTransform){i=i[g.style.transform].split(")")[0].split(", ");j=+(i[12]||i[4]);k=+(i[13]||i[5])}else{j=+i.left.replace(/[^-\d.]/g,"");k=+i.top.replace(/[^-\d.]/g,"")}return{x:j,y:k}},_initIndicators:function(){var o=this.options.interactiveScrollbars,k=typeof this.options.scrollbars!="string",n=[],m;var p=this;this.indicators=[];if(this.options.scrollbars){if(this.options.scrollY){m={el:a("v",o,this.options.scrollbars),interactive:o,defaultScrollbars:true,customStyle:k,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenX:false};this.wrapper.appendChild(m.el);n.push(m)}if(this.options.scrollX){m={el:a("h",o,this.options.scrollbars),interactive:o,defaultScrollbars:true,customStyle:k,resize:this.options.resizeScrollbars,shrink:this.options.shrinkScrollbars,fade:this.options.fadeScrollbars,listenY:false};this.wrapper.appendChild(m.el);n.push(m)}}if(this.options.indicators){n=n.concat(this.options.indicators)}for(var l=n.length;l--;){this.indicators.push(new c(this,n[l]))}function j(q){for(var r=p.indicators.length;r--;){q.call(p.indicators[r])}}if(this.options.fadeScrollbars){this.on("scrollEnd",function(){j(function(){this.fade()})});this.on("scrollCancel",function(){j(function(){this.fade()})});this.on("scrollStart",function(){j(function(){this.fade(1)})});this.on("beforeScrollStart",function(){j(function(){this.fade(1,true)})})}this.on("refresh",function(){j(function(){this.refresh()})});this.on("destroy",function(){j(function(){this.destroy()});delete this.indicators})},_initWheel:function(){g.addEvent(this.wrapper,"wheel",this);g.addEvent(this.wrapper,"mousewheel",this);g.addEvent(this.wrapper,"DOMMouseScroll",this);this.on("destroy",function(){g.removeEvent(this.wrapper,"wheel",this);g.removeEvent(this.wrapper,"mousewheel",this);g.removeEvent(this.wrapper,"DOMMouseScroll",this)})},_wheel:function(i){if(!this.enabled){return}i.preventDefault();i.stopPropagation();var m,n,j,k,l=this;if(this.wheelTimeout===undefined){l._execEvent("scrollStart")}clearTimeout(this.wheelTimeout);this.wheelTimeout=setTimeout(function(){l._execEvent("scrollEnd");l.wheelTimeout=undefined},400);if("deltaX" in i){if(i.deltaMode===1){m=-i.deltaX*this.options.mouseWheelSpeed;n=-i.deltaY*this.options.mouseWheelSpeed}else{m=-i.deltaX;n=-i.deltaY}}else{if("wheelDeltaX" in i){m=i.wheelDeltaX/120*this.options.mouseWheelSpeed;n=i.wheelDeltaY/120*this.options.mouseWheelSpeed}else{if("wheelDelta" in i){m=n=i.wheelDelta/120*this.options.mouseWheelSpeed}else{if("detail" in i){m=n=-i.detail/3*this.options.mouseWheelSpeed}else{return}}}}m*=this.options.invertWheelDirection;n*=this.options.invertWheelDirection;if(!this.hasVerticalScroll){m=n;n=0}if(this.options.snap){j=this.currentPage.pageX;k=this.currentPage.pageY;if(m>0){j--}else{if(m<0){j++}}if(n>0){k--}else{if(n<0){k++}}this.goToPage(j,k);return}j=this.x+e.round(this.hasHorizontalScroll?m:0);k=this.y+e.round(this.hasVerticalScroll?n:0);if(j>0){j=0}else{if(j<this.maxScrollX){j=this.maxScrollX}}if(k>0){k=0}else{if(k<this.maxScrollY){k=this.maxScrollY}}this.scrollTo(j,k,0);if(this.options.probeType>1){this._execEvent("scroll")}},_initSnap:function(){this.currentPage={};if(typeof this.options.snap=="string"){this.options.snap=this.scroller.querySelectorAll(this.options.snap)}this.on("refresh",function(){var p=0,q,r=0,s,j,k,v=0,w,t=this.options.snapStepX||this.wrapperWidth,u=this.options.snapStepY||this.wrapperHeight,o;this.pages=[];if(!this.wrapperWidth||!this.wrapperHeight||!this.scrollerWidth||!this.scrollerHeight){return}if(this.options.snap===true){j=e.round(t/2);k=e.round(u/2);while(v>-this.scrollerWidth){this.pages[p]=[];q=0;w=0;while(w>-this.scrollerHeight){this.pages[p][q]={x:e.max(v,this.maxScrollX),y:e.max(w,this.maxScrollY),width:t,height:u,cx:v-j,cy:w-k};w-=u;q++}v-=t;p++}}else{o=this.options.snap;q=o.length;s=-1;for(;p<q;p++){if(p===0||o[p].offsetLeft<=o[p-1].offsetLeft){r=0;s++}if(!this.pages[r]){this.pages[r]=[]}v=e.max(-o[p].offsetLeft,this.maxScrollX);w=e.max(-o[p].offsetTop,this.maxScrollY);j=v-e.round(o[p].offsetWidth/2);k=w-e.round(o[p].offsetHeight/2);this.pages[r][s]={x:v,y:w,width:o[p].offsetWidth,height:o[p].offsetHeight,cx:j,cy:k};if(v>this.maxScrollX){r++}}}this.goToPage(this.currentPage.pageX||0,this.currentPage.pageY||0,0);if(this.options.snapThreshold%1===0){this.snapThresholdX=this.options.snapThreshold;this.snapThresholdY=this.options.snapThreshold}else{this.snapThresholdX=e.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].width*this.options.snapThreshold);this.snapThresholdY=e.round(this.pages[this.currentPage.pageX][this.currentPage.pageY].height*this.options.snapThreshold)}});this.on("flick",function(){var i=this.options.snapSpeed||e.max(e.max(e.min(e.abs(this.x-this.startX),1000),e.min(e.abs(this.y-this.startY),1000)),300);this.goToPage(this.currentPage.pageX+this.directionX,this.currentPage.pageY+this.directionY,i)})},_nearestSnap:function(o,p){if(!this.pages.length){return{x:0,y:0,pageX:0,pageY:0}}var j=0,k=this.pages.length,n=0;if(e.abs(o-this.absStartX)<this.snapThresholdX&&e.abs(p-this.absStartY)<this.snapThresholdY){return this.currentPage}if(o>0){o=0}else{if(o<this.maxScrollX){o=this.maxScrollX}}if(p>0){p=0}else{if(p<this.maxScrollY){p=this.maxScrollY}}for(;j<k;j++){if(o>=this.pages[j][0].cx){o=this.pages[j][0].x;break}}k=this.pages[j].length;for(;n<k;n++){if(p>=this.pages[0][n].cy){p=this.pages[0][n].y;break}}if(j==this.currentPage.pageX){j+=this.directionX;if(j<0){j=0}else{if(j>=this.pages.length){j=this.pages.length-1}}o=this.pages[j][0].x}if(n==this.currentPage.pageY){n+=this.directionY;if(n<0){n=0}else{if(n>=this.pages[0].length){n=this.pages[0].length-1}}p=this.pages[0][n].y}return{x:o,y:p,pageX:j,pageY:n}},goToPage:function(m,n,l,i){i=i||this.options.bounceEasing;if(m>=this.pages.length){m=this.pages.length-1}else{if(m<0){m=0}}if(n>=this.pages[m].length){n=this.pages[m].length-1}else{if(n<0){n=0}}var j=this.pages[m][n].x,k=this.pages[m][n].y;l=l===undefined?this.options.snapSpeed||e.max(e.max(e.min(e.abs(j-this.x),1000),e.min(e.abs(k-this.y),1000)),300):l;this.currentPage={x:j,y:k,pageX:m,pageY:n};this.scrollTo(j,k,l,i)},next:function(j,i){var k=this.currentPage.pageX,l=this.currentPage.pageY;k++;if(k>=this.pages.length&&this.hasVerticalScroll){k=0;l++}this.goToPage(k,l,j,i)},prev:function(j,i){var k=this.currentPage.pageX,l=this.currentPage.pageY;k--;if(k<0&&this.hasVerticalScroll){k=0;l--}this.goToPage(k,l,j,i)},_initKeys:function(j){var l={pageUp:33,pageDown:34,end:35,home:36,left:37,up:38,right:39,down:40};var k;if(typeof this.options.keyBindings=="object"){for(k in this.options.keyBindings){if(typeof this.options.keyBindings[k]=="string"){this.options.keyBindings[k]=this.options.keyBindings[k].toUpperCase().charCodeAt(0)}}}else{this.options.keyBindings={}}for(k in l){this.options.keyBindings[k]=this.options.keyBindings[k]||l[k]}g.addEvent(h,"keydown",this);this.on("destroy",function(){g.removeEvent(h,"keydown",this)})},_key:function(j){if(!this.enabled){return}var p=this.options.snap,k=p?this.currentPage.pageX:this.x,l=p?this.currentPage.pageY:this.y,m=g.getTime(),o=this.keyTime||0,i=0.25,n;if(this.options.useTransition&&this.isInTransition){n=this.getComputedPosition();this._translate(e.round(n.x),e.round(n.y));this.isInTransition=false}this.keyAcceleration=m-o<200?e.min(this.keyAcceleration+i,50):0;switch(j.keyCode){case this.options.keyBindings.pageUp:if(this.hasHorizontalScroll&&!this.hasVerticalScroll){k+=p?1:this.wrapperWidth}else{l+=p?1:this.wrapperHeight}break;case this.options.keyBindings.pageDown:if(this.hasHorizontalScroll&&!this.hasVerticalScroll){k-=p?1:this.wrapperWidth}else{l-=p?1:this.wrapperHeight}break;case this.options.keyBindings.end:k=p?this.pages.length-1:this.maxScrollX;l=p?this.pages[0].length-1:this.maxScrollY;break;case this.options.keyBindings.home:k=0;l=0;break;case this.options.keyBindings.left:k+=p?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.up:l+=p?1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.right:k-=p?-1:5+this.keyAcceleration>>0;break;case this.options.keyBindings.down:l-=p?1:5+this.keyAcceleration>>0;break;default:return}if(p){this.goToPage(k,l);return}if(k>0){k=0;this.keyAcceleration=0}else{if(k<this.maxScrollX){k=this.maxScrollX;this.keyAcceleration=0}}if(l>0){l=0;this.keyAcceleration=0}else{if(l<this.maxScrollY){l=this.maxScrollY;this.keyAcceleration=0}}this.scrollTo(k,l,0);this.keyTime=m},_animate:function(j,k,l,m){var r=this,o=this.x,p=this.y,n=g.getTime(),i=n+l;function q(){var v=g.getTime(),t,u,s;if(v>=i){r.isAnimating=false;r._translate(j,k);if(!r.resetPosition(r.options.bounceTime)){r._execEvent("scrollEnd")}return}v=(v-n)/l;s=m(v);t=(j-o)*s+o;u=(k-p)*s+p;r._translate(t,u);if(r.isAnimating){f(q)}if(r.options.probeType==3){r._execEvent("scroll")}}this.isAnimating=true;q()},handleEvent:function(i){switch(i.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(i);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(i);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(i);break;case"orientationchange":case"resize":this._resize();break;case"transitionend":case"webkitTransitionEnd":case"oTransitionEnd":case"MSTransitionEnd":this._transitionEnd(i);break;case"wheel":case"DOMMouseScroll":case"mousewheel":this._wheel(i);break;case"keydown":this._key(i);break;case"click":if(!i._constructed){i.preventDefault();i.stopPropagation()}break}}};function a(i,k,m){var l=b.createElement("div"),j=b.createElement("div");if(m===true){l.style.cssText="position:absolute;z-index:9999";j.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;background:rgba(0,0,0,0.5);border:1px solid rgba(255,255,255,0.9);border-radius:3px"}j.className="iScrollIndicator";if(i=="h"){if(m===true){l.style.cssText+=";height:7px;left:2px;right:2px;bottom:0";j.style.height="100%"}l.className="iScrollHorizontalScrollbar"}else{if(m===true){l.style.cssText+=";width:7px;bottom:2px;top:2px;right:1px";j.style.width="100%"}l.className="iScrollVerticalScrollbar"}l.style.cssText+=";overflow:hidden";if(!k){l.style.pointerEvents="none"}l.appendChild(j);return l}function c(l,k){this.wrapper=typeof k.el=="string"?b.querySelector(k.el):k.el;this.wrapperStyle=this.wrapper.style;this.indicator=this.wrapper.children[0];this.indicatorStyle=this.indicator.style;this.scroller=l;this.options={listenX:true,listenY:true,interactive:false,resize:true,defaultScrollbars:false,shrink:false,fade:false,speedRatioX:0,speedRatioY:0};for(var j in k){this.options[j]=k[j]}this.sizeRatioX=1;this.sizeRatioY=1;this.maxPosX=0;this.maxPosY=0;if(this.options.interactive){if(!this.options.disableTouch){g.addEvent(this.indicator,"touchstart",this);g.addEvent(h,"touchend",this)}if(!this.options.disablePointer){g.addEvent(this.indicator,g.prefixPointerEvent("pointerdown"),this);g.addEvent(h,g.prefixPointerEvent("pointerup"),this)}if(!this.options.disableMouse){g.addEvent(this.indicator,"mousedown",this);g.addEvent(h,"mouseup",this)}}if(this.options.fade){this.wrapperStyle[g.style.transform]=this.scroller.translateZ;this.wrapperStyle[g.style.transitionDuration]=g.isBadAndroid?"0.001s":"0ms";this.wrapperStyle.opacity="0"}}c.prototype={handleEvent:function(i){switch(i.type){case"touchstart":case"pointerdown":case"MSPointerDown":case"mousedown":this._start(i);break;case"touchmove":case"pointermove":case"MSPointerMove":case"mousemove":this._move(i);break;case"touchend":case"pointerup":case"MSPointerUp":case"mouseup":case"touchcancel":case"pointercancel":case"MSPointerCancel":case"mousecancel":this._end(i);break}},destroy:function(){if(this.options.interactive){g.removeEvent(this.indicator,"touchstart",this);g.removeEvent(this.indicator,g.prefixPointerEvent("pointerdown"),this);g.removeEvent(this.indicator,"mousedown",this);g.removeEvent(h,"touchmove",this);g.removeEvent(h,g.prefixPointerEvent("pointermove"),this);g.removeEvent(h,"mousemove",this);g.removeEvent(h,"touchend",this);g.removeEvent(h,g.prefixPointerEvent("pointerup"),this);g.removeEvent(h,"mouseup",this)}if(this.options.defaultScrollbars){this.wrapper.parentNode.removeChild(this.wrapper)}},_start:function(i){var j=i.touches?i.touches[0]:i;i.preventDefault();i.stopPropagation();this.transitionTime();this.initiated=true;this.moved=false;this.lastPointX=j.pageX;this.lastPointY=j.pageY;this.startTime=g.getTime();if(!this.options.disableTouch){g.addEvent(h,"touchmove",this)}if(!this.options.disablePointer){g.addEvent(h,g.prefixPointerEvent("pointermove"),this)}if(!this.options.disableMouse){g.addEvent(h,"mousemove",this)}this.scroller._execEvent("beforeScrollStart")},_move:function(k){var n=k.touches?k.touches[0]:k,i,j,l,m,o=g.getTime();if(!this.moved){this.scroller._execEvent("scrollStart")}this.moved=true;i=n.pageX-this.lastPointX;this.lastPointX=n.pageX;j=n.pageY-this.lastPointY;this.lastPointY=n.pageY;l=this.x+i;m=this.y+j;this._pos(l,m);if(this.scroller.options.probeType==1&&o-this.startTime>300){this.startTime=o;this.scroller._execEvent("scroll")}else{if(this.scroller.options.probeType>1){this.scroller._execEvent("scroll")}}k.preventDefault();k.stopPropagation()},_end:function(i){if(!this.initiated){return}this.initiated=false;i.preventDefault();i.stopPropagation();g.removeEvent(h,"touchmove",this);g.removeEvent(h,g.prefixPointerEvent("pointermove"),this);g.removeEvent(h,"mousemove",this);if(this.scroller.options.snap){var j=this.scroller._nearestSnap(this.scroller.x,this.scroller.y);var k=this.options.snapSpeed||e.max(e.max(e.min(e.abs(this.scroller.x-j.x),1000),e.min(e.abs(this.scroller.y-j.y),1000)),300);if(this.scroller.x!=j.x||this.scroller.y!=j.y){this.scroller.directionX=0;this.scroller.directionY=0;this.scroller.currentPage=j;this.scroller.scrollTo(j.x,j.y,k,this.scroller.options.bounceEasing)}}if(this.moved){this.scroller._execEvent("scrollEnd")}},transitionTime:function(i){i=i||0;this.indicatorStyle[g.style.transitionDuration]=i+"ms";if(!i&&g.isBadAndroid){this.indicatorStyle[g.style.transitionDuration]="0.001s"}},transitionTimingFunction:function(i){this.indicatorStyle[g.style.transitionTimingFunction]=i},refresh:function(){this.transitionTime();if(this.options.listenX&&!this.options.listenY){this.indicatorStyle.display=this.scroller.hasHorizontalScroll?"block":"none"}else{if(this.options.listenY&&!this.options.listenX){this.indicatorStyle.display=this.scroller.hasVerticalScroll?"block":"none"}else{this.indicatorStyle.display=this.scroller.hasHorizontalScroll||this.scroller.hasVerticalScroll?"block":"none"}}if(this.scroller.hasHorizontalScroll&&this.scroller.hasVerticalScroll){g.addClass(this.wrapper,"iScrollBothScrollbars");g.removeClass(this.wrapper,"iScrollLoneScrollbar");if(this.options.defaultScrollbars&&this.options.customStyle){if(this.options.listenX){this.wrapper.style.right="8px"}else{this.wrapper.style.bottom="8px"}}}else{g.removeClass(this.wrapper,"iScrollBothScrollbars");g.addClass(this.wrapper,"iScrollLoneScrollbar");if(this.options.defaultScrollbars&&this.options.customStyle){if(this.options.listenX){this.wrapper.style.right="2px"}else{this.wrapper.style.bottom="2px"}}}var i=this.wrapper.offsetHeight;if(this.options.listenX){this.wrapperWidth=this.wrapper.clientWidth;if(this.options.resize){this.indicatorWidth=e.max(e.round(this.wrapperWidth*this.wrapperWidth/(this.scroller.scrollerWidth||this.wrapperWidth||1)),8);this.indicatorStyle.width=this.indicatorWidth+"px"}else{this.indicatorWidth=this.indicator.clientWidth}this.maxPosX=this.wrapperWidth-this.indicatorWidth;if(this.options.shrink=="clip"){this.minBoundaryX=-this.indicatorWidth+8;this.maxBoundaryX=this.wrapperWidth-8}else{this.minBoundaryX=0;this.maxBoundaryX=this.maxPosX}this.sizeRatioX=this.options.speedRatioX||(this.scroller.maxScrollX&&(this.maxPosX/this.scroller.maxScrollX))}if(this.options.listenY){this.wrapperHeight=this.wrapper.clientHeight;if(this.options.resize){this.indicatorHeight=e.max(e.round(this.wrapperHeight*this.wrapperHeight/(this.scroller.scrollerHeight||this.wrapperHeight||1)),8);this.indicatorStyle.height=this.indicatorHeight+"px"}else{this.indicatorHeight=this.indicator.clientHeight}this.maxPosY=this.wrapperHeight-this.indicatorHeight;if(this.options.shrink=="clip"){this.minBoundaryY=-this.indicatorHeight+8;this.maxBoundaryY=this.wrapperHeight-8}else{this.minBoundaryY=0;this.maxBoundaryY=this.maxPosY}this.maxPosY=this.wrapperHeight-this.indicatorHeight;this.sizeRatioY=this.options.speedRatioY||(this.scroller.maxScrollY&&(this.maxPosY/this.scroller.maxScrollY))}this.updatePosition()},updatePosition:function(){var i=this.options.listenX&&e.round(this.sizeRatioX*this.scroller.x)||0,j=this.options.listenY&&e.round(this.sizeRatioY*this.scroller.y)||0;if(!this.options.ignoreBoundaries){if(i<this.minBoundaryX){if(this.options.shrink=="scale"){this.width=e.max(this.indicatorWidth+i,8);this.indicatorStyle.width=this.width+"px"}i=this.minBoundaryX}else{if(i>this.maxBoundaryX){if(this.options.shrink=="scale"){this.width=e.max(this.indicatorWidth-(i-this.maxPosX),8);this.indicatorStyle.width=this.width+"px";i=this.maxPosX+this.indicatorWidth-this.width}else{i=this.maxBoundaryX}}else{if(this.options.shrink=="scale"&&this.width!=this.indicatorWidth){this.width=this.indicatorWidth;this.indicatorStyle.width=this.width+"px"}}}if(j<this.minBoundaryY){if(this.options.shrink=="scale"){this.height=e.max(this.indicatorHeight+j*3,8);this.indicatorStyle.height=this.height+"px"}j=this.minBoundaryY}else{if(j>this.maxBoundaryY){if(this.options.shrink=="scale"){this.height=e.max(this.indicatorHeight-(j-this.maxPosY)*3,8);this.indicatorStyle.height=this.height+"px";j=this.maxPosY+this.indicatorHeight-this.height}else{j=this.maxBoundaryY}}else{if(this.options.shrink=="scale"&&this.height!=this.indicatorHeight){this.height=this.indicatorHeight;this.indicatorStyle.height=this.height+"px"}}}}this.x=i;this.y=j;if(this.scroller.options.useTransform){this.indicatorStyle[g.style.transform]="translate("+i+"px,"+j+"px)"+this.scroller.translateZ}else{this.indicatorStyle.left=i+"px";this.indicatorStyle.top=j+"px"}},_pos:function(i,j){if(i<0){i=0}else{if(i>this.maxPosX){i=this.maxPosX}}if(j<0){j=0}else{if(j>this.maxPosY){j=this.maxPosY}}i=this.options.listenX?e.round(i/this.sizeRatioX):this.scroller.x;j=this.options.listenY?e.round(j/this.sizeRatioY):this.scroller.y;this.scroller.scrollTo(i,j)},fade:function(l,j){if(j&&!this.visible){return}clearTimeout(this.fadeTimeout);this.fadeTimeout=null;var k=l?250:500,i=l?0:300;l=l?"1":"0";this.wrapperStyle[g.style.transitionDuration]=k+"ms";this.fadeTimeout=setTimeout((function(m){this.wrapperStyle.opacity=m;this.visible=+m}).bind(this,l),i)}};d.utils=g;if(typeof module!="undefined"&&module.exports){module.exports=d}else{h.IScroll=d}})(window,document,Math);